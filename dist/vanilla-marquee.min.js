const t={css3easing:"linear",delayBeforeStart:1e3,direction:"left",duplicated:!1,duration:5e3,gap:20,pauseOnHover:!1,recalcResize:!1,speed:0,startVisible:!1};let s=0;class i{constructor(i,e){if(void 0===i)throw new Error("el cannot be undefined");if("string"==typeof i)throw new Error("el cannot be just a selector");if(null===i)throw new Error("el cannot be null");e={...t,...e},this.t=i,this.i=3;for(const s in t){let h=i.getAttribute(`data-${t[s]}`);null!==h&&""!==h&&("true"!==h&&"false"!==h||(h=Boolean(h)),e[s]=h)}e.speed&&(e.duration=parseInt(i.clientWidth)/e.speed*1e3),e.gap=e.duplicated?parseInt(e.gap):0,i.innerHTML=`<div class="js-marquee">${i.innerHTML}</div>`;const h=document.getElementsByClassName("js-marquee",i)[0];h.style.marginRight=`${e.gap}px`,h.style.willChange="transform",h.style.float="left",e.duplicated&&i.appendChild(h.cloneNode(!0)),i.innerHTML=`<div style="width:100000px" class="js-marquee-wrapper">${i.innerHTML}</div>`;const n=document.getElementsByClassName("js-marquee-wrapper",i)[0],a="up"===e.direction||"down"===e.direction;this.h=n,this.o=a,this.u=e.duration,this.p=e,this.l();const r=`marqueeAnimation-${Math.floor(1e7*Math.random())}`,o=this.m(r,e.duration/1e3,e.delayBeforeStart/1e3,"infinite");this.$=r,this.v=o,e.duplicated?(a?e.startVisible?this.h.style.transform="translateY(0px)":this.h.style.transform=`translateY(${"up"===e.direction?this.I:-1*(2*this.q-e.gap)}px)`:e.startVisible?this.h.style.transform="translateX(0px)":this.h.style.transform=`translateX(${"left"===e.direction?this.j:-1*(2*this.S-e.gap)}px)`,e.startVisible||(this.i=1)):e.startVisible?this.i=2:a?this.X():this.Y(),this.t.addEventListener("pause",this.pause.bind(this)),this.t.addEventListener("resume",this.resume.bind(this)),e.pauseOnHover&&(this.t.addEventListener("mouseover",this.pause.bind(this)),this.t.addEventListener("mouseout",this.resume.bind(this))),this._=()=>{this.C(a),this.t.dispatchEvent(new CustomEvent("finished"))},this.B=s,s++,this.C(a),e.recalcResize&&window.addEventListener("resize",this.H.bind(this))}m(t="",s=0,i=0,e=""){return`${t} ${s}s ${i}s ${e} ${this.p.css3easing}`}C(t=!1){const s=this.p;if(s.duplicated){if(1===this.i){let i=s.duration;i=t?"up"===s.direction?i+this.I/(this.q/i):2*i:"left"===s.direction?i+this.j/(this.S/i):2*i,this.v=this.m(this.$,i/1e3,s.delayBeforeStart/1e3)}else 2===this.i&&(this.$=`${this.$}0`,this.v=this.m(this.$,s.duration/1e3,0,"infinite"));this.i++}let i="";t?s.duplicated?(this.i>2&&(this.h.style.transform=`translateY(${"up"===s.direction?0:-1*this.q}px)`),i=`translateY(${"up"===s.direction?-1*this.q:0}px)`):s.startVisible?2===this.i?(this.v=this.m(this.$,s.duration/1e3,s.delayBeforeStart/1e3),i=`translateY(${"up"===s.direction?-1*this.q:this.I}px)`,this.i++):3===this.i&&(this.$=`${this.$}0`,this.v=this.m(this.$,this.M/1e3,0,"infinite"),this.X()):(this.X(),i=`translateY(${"up"===s.direction?-1*this.h.clientHeight:this.I}px)`):s.duplicated?(this.i>2&&(this.h.style.transform=`translateX(${"left"===s.direction?0:-1*this.S}px)`),i=`translateX(${"left"===s.direction?-1*this.S:0}px)`):s.startVisible?2===this.i?(this.v=this.m(this.$,s.duration/1e3,s.delayBeforeStart/1e3),i=`translateX(${"left"===s.direction?-1*this.S:this.j}px)`,this.i++):3===this.i&&(this.$=`${this.$}0`,this.v=this.m(this.$,s.duration/1e3,0,"infinite"),this.Y()):(this.Y(),i=`translateX(${"left"===s.direction?-1*this.S:this.j}px)`),this.t.dispatchEvent(new CustomEvent("beforeStarting")),this.h.style.animation=this.v;const e=`@keyframes ${this.$} {\n        100% {\n          transform: ${i};\n        }\n      }`,h=document.querySelectorAll("style",this.h);if(h.length)h[h.length-1].innerHTML=e;else if(document.getElementsByClassName(`marq-wrap-style-${this.B}`).length)document.getElementsByClassName(`marq-wrap-style-${this.B}`)[0].innerHTML=e;else{const t=document.createElement("style");t.classList.add(`marq-wrap-style-${this.B}`),t.innerHTML=e,document.querySelector("head").appendChild(t)}this.h.addEventListener("animationiteration",this.R.bind(this),{once:!0}),this.h.addEventListener("animationend",this._.bind(this),{once:!0}),this.V="running",this.t.setAttribute("data-runningStatus","resumed")}R(){this.t.dispatchEvent(new CustomEvent("finished"))}X(){this.h.style.transform=`translateY(${"up"===this.p.direction?this.I:-1*this.q}px)`}Y(){this.h.style.transform=`translateX(${"left"===this.p.direction?this.j:-1*this.S}px)`}l(){const t=this.t,s=this.p;if(this.o){const i=t.clientHeight;this.I=i,this.h.removeAttribute("style"),t.style.clientHeight=`${i}px`;const e=document.getElementsByClassName("js-marquee",t),h=e.length-1;for(const t in e)t.style.float="none",t.style.marginRight="0px",s.duplicated&&ind===h?t.style.marginBottom="0px":t.style.marginBottom=`${s.gap}px`;const n=parseInt(e[0].clientHeight+s.gap);this.q=n,s.startVisible&&!s.duplicated?(this.M=(n+i)/parseInt(i)*this.u,s.duration=n/parseInt(i)*this.u):s.duration=n/parseInt(i)/parseInt(i)*this.u}else{const i=parseInt(document.getElementsByClassName("js-marquee",t)[0].clientWidth+s.gap),e=t.clientWidth;this.j=e,this.S=i,s.startVisible&&!s.duplicated?(this.M=(i+e)/parseInt(e)*this.u,s.duration=i/parseInt(e)*this.u):s.duration=(i+parseInt(e))/parseInt(e)*this.u}s.duplicated&&(s.duration=s.duration/2)}H(){this.l(),this.i=2,this._()}pause(){this.h.style.animationPlayState="paused",this.V="paused",this.t.setAttribute("data-runningStatus","paused"),this.t.dispatchEvent(new CustomEvent("paused"))}resume(){this.h.style.animationPlayState="running",this.V="running",this.t.setAttribute("data-runningStatus","resumed"),this.t.dispatchEvent(new CustomEvent("resumed"))}toggle(){"paused"===this.V?this.resume():"running"===this.V&&this.pause()}destroy(){this.t.removeEventListener("pause",this.pause.bind(this)),this.t.removeEventListener("resume",this.resume.bind(this)),this.p.pauseOnHover&&(this.t.removeEventListener("mouseover",this.pause.bind(this)),this.t.removeEventListener("mouseout",this.resume.bind(this))),this.h.removeEventListener("animationiteration",this.R.bind(this),{once:!0}),this.h.removeEventListener("animationend",this._.bind(this),{once:!0}),this.p.recalcResize&&window.removeEventListener("resize",this.H.bind(this))}refresh(){this.H()}}export{i as default};
